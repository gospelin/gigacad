{% extends 'admin/base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-3">
        <div class="card bg-primary text-light mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Students</h5>
                <p class="card-text" id="total-students">234</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-light mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Teachers</h5>
                <p class="card-text" id="total-teachers">20</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-dark mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Parents</h5>
                <p class="card-text" id="total-parents">115</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-danger text-light mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Classes</h5>
                <p class="card-text" id="total-classes">10</p>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Student Enrollment</h5>
                <canvas id="studentChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Teacher Distribution</h5>
                <canvas id="teacherChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
{% endblock %}

{% block scripts %}

    <script>
        $(document).ready(function () {
            $(".sidebar-toggler").on("click", function () {
                $(".sidebar").toggleClass("open");
                setTimeout(function () {
                    studentChart.resize();
                    teacherChart.resize();
                }, 300);
            });

            // Active link highlighting
            var path = window.location.pathname;
            if (path.includes("dashboard")) {
                $("#dashboard-link").addClass("active");
            } else if (path.includes("approve_students")) {
                $("#students-link").addClass("active");
            }

            // Display the total values
            $("#total-students").text(234);
            $("#total-teachers").text(20);
            $("#total-parents").text(115);
            $("#total-classes").text(10);

            // Initialize the Student Enrollment Chart
            const studentChartCtx = document.getElementById("studentChart").getContext("2d");
            const studentChart = new Chart(studentChartCtx, {
                type: "bar",
                data: {
                    labels: ["Basic 1", "Basic 2", "Basic 3", "Basic 4", "Basic 5"],
                    datasets: [{
                        label: "# of Students",
                        data: [12, 19, 3, 5, 2],
                        backgroundColor: "rgba(54, 162, 235, 0.5)",
                        borderColor: "rgba(54, 162, 235, 1)",
                        borderWidth: 1,
                    }],
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                        },
                    },
                },
            });

            // Initialize the Teacher Distribution Chart
            const teacherChartCtx = document.getElementById("teacherChart").getContext("2d");
            const teacherChart = new Chart(teacherChartCtx, {
                type: "pie",
                data: {
                    labels: ["Math", "Science", "English", "History", "Art"],
                    datasets: [{
                        label: "# of Teachers",
                        data: [3, 5, 2, 4, 6],
                        backgroundColor: [
                            "rgba(255, 99, 132, 0.5)",
                            "rgba(54, 162, 235, 0.5)",
                            "rgba(255, 206, 86, 0.5)",
                            "rgba(75, 192, 192, 0.5)",
                            "rgba(153, 102, 255, 0.5)",
                        ],
                        borderColor: [
                            "rgba(255, 99, 132, 1)",
                            "rgba(54, 162, 235, 1)",
                            "rgba(255, 206, 86, 1)",
                            "rgba(75, 192, 192, 1)",
                            "rgba(153, 102, 255, 1)",
                        ],
                        borderWidth: 1,
                    }],
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: "top",
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return context.label + ": " + context.raw;
                                },
                            },
                        },
                    },
                },
            });
        });
    </script>
{% endblock %}